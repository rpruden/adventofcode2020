$data = "...........#..#.#.###....#.....", "...#..#...........#.#...#......", "#.....#..#........#...#..##....", "..#...##.#.....#.............#.", "#.#..#......#.....#....#.......", ".....#......#..#....#.....#....", ".......#.#..............#......", ".....#...#..........##...#.....", "...#....#.#...#.#........#...#.", "..#.........###.......##...##..", ".#....#...........#........#..#", "..#.............##.............", "..#.##.#....#................#.", ".....##.#.......#....#...#.....", "......#.#....##................", "..#..........###..#..#.#..#....", "....#..............#....##..#.#", ".#.........#.#....#.#.#....#...", "..#.....#......##.#....#.......", "..#.#....#..#.#...##....###....", "...#......##...#........#.#..#.", ".##.#.......##....#............", "...##..#.#............#...#.#..", ".##...##.#..#..................", "..#......##......#......##.....", ".....##...#..#...#.........#...", ".##.#.....#..#..#.##....##....#", "..#.#......#.......##..........", "......................#......##", "##.#...#.................#.#.#.", "......#.#..........#.....##.#..", "#.#......#.....#...........#...", ".....#...#.......#..#..#.#...#.", "...........#......#.#...#......", "....##...##...........#......#.", ".........#.##..................", "......#...#....#......##.##...#", "......#...#.#########......#...", ".......#.#...#.......#..#......", "............#...#...#.###...##.", "...........#..........#...#....", "...#..#.#................#.#..#", "..#....#.....#.............#.#.", "....##......#........#....#....", "........##...............#....#", "........#..#...#..............#", "...#....#.#...#..#...#....#.#.#", ".........#.......#....##.......", "#.##..............#.#........##", "......................###......", ".........#....##..##....#.#.#..", ".#...##.#.#...#....##..#.....#.", "....................#.#......#.", ".#..#.......................#..", "..#..#.............#..#....#...", "...#...#..#...#...#.#..#.##....", "........#....#...#....#........", ".#.....#........#.........#...#", "...#......#..#..#..####..#.....", "#....#..............#.##.......", ".#....#.............##...#.....", "....#...#.##........##......#..", "##....#...#.......#..#........#", "....##........................#", "..................#..#.........", "..#....#........#..#.......#...", "#...#..#....#...##...........#.", ".........#..#..#.#.##..........", "....#.#..#.....#..#.#.#.#..#.##", "##................#.##.....#...", ".#.....###..#..#..#.....#....##", "...#...........#..........####.", ".#.....#....#......#.##..#.#...", "..#...##....#................#.", "........#.......#......#.#.....", "....#.#.#.#....#...#......#..#.", "...........#......#..#.........", "###...##......##.#..#....##....", "##....##.........#..#....###...", "#.#.....#....#......#...#..##..", "#....##.#..............#.##....", ".#........#.#.........#...#....", "......................#......#.", "........#..#..##.....#..#.#....", "..#...###.................#..#.", "...#...#............#..........", ".##.......#..#.........#....#..", ".#..............#....#....##...", "...............##..#.#.......##", ".#.....#....#...#..#.......#..#", "#..#.............#....#......#.", ".....#.#......#.........###..#.", ".#...#.#...............#....#..", "#......#.............#.........", ".#.##.#.####...#..#.##..#.....#", ".....#......#..#...#.......#...", "#........###...#.....#..#.....#", "....#.#.....#...#..........#...", "...#.#.......#.#......#..#.##..", "..#..........#.#..#.......#.#..", "#...#.#..............#...###.#.", "...#..#...#............###.....", "..#..#...#.#............#..#...", ".###.#.....................#..#", "....#....#..#.....##.##........", "#....#....#.#..#.........#.....", ".#.....##....#............##..#", "#....#.#...#...#..#.#......#...", "#.....##.....##.....##.#...##..", "...##...#..#..####.#........#..", ".........#...#......##..##..#..", "..#.....###.#..#..####.#.......", ".......#......#...#..##....#...", ".#.....#.#.#..#....#...#..##...", "..........#.#...#...#.#..#.....", "....#.....#........#.....##..#.", "..#.#.##.........#...##.....##.", ".........#.##....#............#", "............##.....#.......#.#.", "......#.....#...#..#..###......", "##.....#.......#...##.#....#...", "...........##......#..##...#.#.", "..#.#.#.#...#.......#....#...#.", "#.............#.....#.#...###..", "##....#.......#.....#..##.#....", "...#.......#....#.........##...", "......#.......#......##.##.....", "..#......#...#.#........#......", "....#.#....#.#.##......#.....#.", "#......#.........#..#....#.....", "........#..#....##.....#.......", "#......##....#.##....#......#..", "..#.......#............##.....#", "...........#...#...........#...", "#.......#...#....#....#...#.#.#", "..###..#........#........#.....", "..#..###...........#.#......#..", ".#...........#......#..........", ".#.......#.....#.......#.......", "..#......##.#............#....#", "#..........#.....#.#..#........", ".....#...##.##.......#......#..", "..........#.....#........#.#.#.", "....#......#.....#......#.#....", ".........#.#.#..#...##....#...#", ".........#.......#...##...#.#..", ".##........#...............#...", ".......#....#...........##.....", ".........###......#.........#.#", "......#.......#...#..........#.", "...#.#..........##......#...#..", "#.......#.#..........#.........", "................#..#......#..##", ".....#...#....#.#.....#........", "#.....#....#...........#....#..", "#....#.#..#...##....#...##.#...", "...#.....#......#.#....#..#..#.", "..#................#...#.#..##.", "..........#..............#..#.#", ".....##.....#..#.###...........", "....#.#......#.#...........#...", ".#....#.#.........##.#....#....", ".#.#........#........###....#..", "##.#................#...#..#...", ".......#......##..#.....#..#.#.", "...#............#......###...##", "#.#...........#.........#......", ".....#.#.#.................#...", "....#..............#...#.#.....", "...#.#.....##..#...............", ".#..##...#....##.....###..#....", "...............#...#...#.#.###.", ".###....#.....#...#.#......#...", "...#..#.....#.......#..##.#....", "...........#..#....##..#...#...", "...#...#..........#.......##.#.", "............#.#.......#........", "....#.........#.....#..........", "...#.###.##..#...##..####..#..#", ".#.#...#..#...................#", ".....#..#.....##..#............", "....#......#...##..#.##........", "...#...............#..#.....##.", "...#......#.........#.#..##....", ".#....#.##.......#......#......", "....#.......#....#..........#..", "#.#.#....###.#.#.............#.", "..##..###........#.#..#.#..#...", "......#.#............##.#...###", ".........#.#....#####.....##...", "............##......#.#..#.....", "...#.....#.....###....#........", "##..........####.##.#.#........", "....................##.....##.#", "#.#............#........#......", "....#...##.....#......#....#...", "...###.#..##..................#", "..###......#..............#.#.#", ".#...#...........#....#........", "....#............#..#..#.#.....", "...#.........#.#.........#.####", "..#...#...#...#...........#....", "...............#.#......##..#..", "#....#.#.......#.#..#......#..#", "........#.#....#..#...#..#...#.", "...#..#.......#...........#....", "...........#.......#...........", ".#......#................#.....", "....#.#.#...#......#..#...#....", "................#.#.#....#.....", ".........................##..#.", ".#...........#............##...", "#...............#.....##.#.#..#", ".........#.......###....#.....#", "....##...#...#.....#..#........", "........#.....#..#.#.#...#..#..", "......#.......#.#.........#.#..", "#......#............#...#....#.", "#..##...#..#................#..", ".##...#...#.....#.##.......#..#", ".......#.##........##..##......", "##.#..##...............#.....#.", "......#....#..##...#......###.#", "#........##..#....#.#......#...", ".#......##.#...#.#...#.........", ".#.#...#..#.............#......", ".##..........#..........#......", ".#.....#.....#..............#.#", "..#.........#..#.#.....#.#....#", "..#.##..............##...#..###", "....................#..........", "......###..#..#...........#....", "..#..........#.......#...#.....", "...#......#......#.............", "....##..............#.#.....#..", "........#.#......#..#........##", ".............#...#.#.........##", "...###...#..........##.......#.", ".#..........#...##..#.#.....#..", "##...#.........#...............", "......#....#....#.....#.....#..", "..........#....#...#...#..#...#", "...##....#.#.#..#...##.........", "#......#.#...##.###...#....#...", "##.......##.#......##..#...#...", "......#.............#.##.....##", "#.......###....####.#...##....#", "..#...#..#.......#..........#..", "#.....#..#..#..#.##...###...#..", ".....##.#..#..#..#.#....#...#..", "..#...#..................##....", "....#.#........##..............", "#...#.......##...#...#.#.......", "..#...#........##....#.#.......", "..........###...###...#......#.", "#.....#..###...##...##..#..#..#", "..#.....##.....#.......##..#.#.", "........#........#.........#...", ".................#....#.......#", ".......#...#.....#...#.#.......", "....##...............#...##...#", ".##...#................#...#...", ".............#.................", ".#..#....#....#.#....#.........", ".#.#..#..........#.......#.....", ".....##.....##...#..#..........", "#...#.#.........#......#..#....", "........#....#...#....#.#.##...", "....#..#........#...#...#......", ".#..#.....#.#...#.........#....", ".#..#..#...........#..#....#...", "....###.............#..#.......", "#......#..#..##..........#.#...", "#..#..#.##..#...#.#.#..........", "....###......#.##.....#....#...", ".##..#...#......##.#...........", "..#..#.......#.....#.##....#.#.", ".......#.#.#........#....##....", "..##...#....#...............###", "#..##..#...........#.#....##...", "...##..#.....................#.", "###......#....#....###..#...##.", ".........##............#..#...#", "..#..........#...#.#.#......#.#", ".......#.....##..##......#.##..", "#..........#.....##.#..........", "#.......#.#...#...#....#.......", "#...#.....##.......#.#..#.#.#..", ".........#.#.#..#..#...#.###...", ".................##...#....#...", "###.......#..........##...#....", "#.#..#.........#....##.#.......", "......#.#.....#........#.......", ".......#.#........#......#.#..#", "..............#..#...##....#..#", "#...........#...##.....#..#.#..", "..#....#..#.#.#...#..#....#.#..", "...##.#.....#..#...##..#.....#.", "..#.#................#........#", "......#...#.............#......", ".##............#....#...#..#...", "....#...#...........#.......#..", ".###..#.......#.............#.#", ".#.#....#.#...........#.#......", "...#.........#.........#..#....", "...#..........#.#.....#.#......", ".....#........#....##......#...", "..#.#.#......#..#.#......#....#", ".#.#..#................#.#.....", ".#.#.........##...#.......#.#.#", "#..#.....#...#..#...........#..", "..##......####......#..#....###", "#.....###....#.#........#..#..#", "..##.#...#.#..##..........#..#.", "#.........#.#.............#...#", "...#.#...#...#.#.#....##.......", "##.##...#.....#...#...........#", "....#........#.#.....#.........", ".................##..#..##...##", ".....##....#...#...#.....#..#..", "....#...#........#............#", "..#...........##....#...#...##.", ".....#......#.........#..##.#.."

function Check-Slopes($moveRight,$moveDown) {
    ## These variables map the starting position
    $downPosition = 1
    $rightPosition = 1
    $currentPosition = $downPosition, $rightPosition
    
    # Start Script
    $currentStep = 1
    foreach ($line in $data) {
        #check line length. If too long, wrap around.
        if ($currentPosition[1] -gt $line.length) {
        $currentPosition[1] = $currentPosition[1] - $line.length
        }
    
        #Write values to screen (optional)
        #Write-Host "Step $currentStep, Location $currentPosition $line"
    
        #Check for trees and count them
        if ($moveDown -gt 1) {
            if ($currentStep %2 -eq 1) {
                $treeVar = $line.substring($currentPosition[1]-1,1)
                if ($treeVar -eq "#") {
                    $totalCount = $totalCount + 1
                    }
            #Write values to screen (optional)
            #Write-Host "Step $currentStep, Location $currentPosition $line"               
            }
        }
        Else {
            $treeVar = $line.substring($currentPosition[1]-1,1)
            if ($treeVar -eq "#") {
                $totalCount = $totalCount + 1
                }
            #Write values to screen (optional)
            #Write-Host "Step $currentStep, Location $currentPosition $line"
            }

        
    
        #Check if final line has been read, if not count upward, wrapping if necessary
        if ($currentPosition[0] -le $dataLines) {
            $currentPosition[0] = $currentPosition[0]+$moveDown
            $currentPosition[1] = $currentPosition[1]+$moveRight
            if ($currentPosition[1] -gt $line.length) {
                $currentPosition[1] = $currentPosition[1] - $line.length
                #Write-Host Position changed to $currentPosition[1]
                }
        }
    
        #Increment Step by 1
        $currentStep = $currentStep +1
    }
    
      Write-host "$dataLines lines processed; $totalCount trees encountered"
    }

#Part 1
#Variables
##Count number of lines to be processed
[int]$dataLines = ($data | measure).count
$totalCount = 0

## These variables map the movement trajectory for each pass
#$moveRight = Read-Host "Enter the Right Value"
#$moveDown = Read-Host "Enter the Down Value"
#$slopeID = Read-Host "Enter the Slope ID Number"
#$moveDown = 1
#$moveRight = 3


#Part 2
## These variables map the movement of slope trajectories for each pass
$slope1 = 1, 1
$slope2 = 3, 1
$slope3 = 5, 1
$slope4 = 7, 1
$slope5 = 1, 2

# Start Script
Check-Slopes $slope1[0] $slope1[1]
Check-Slopes $slope2[0] $slope2[1]
Check-Slopes $slope3[0] $slope3[1]
Check-Slopes $slope4[0] $slope4[1]
Check-Slopes $slope5[0] $slope5[1]
