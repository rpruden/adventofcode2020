$data = "...........#..#.#.###....#.....", "...#..#...........#.#...#......", "#.....#..#........#...#..##....", "..#...##.#.....#.............#.", "#.#..#......#.....#....#.......", ".....#......#..#....#.....#....", ".......#.#..............#......", ".....#...#..........##...#.....", "...#....#.#...#.#........#...#.", "..#.........###.......##...##..", ".#....#...........#........#..#", "..#.............##.............", "..#.##.#....#................#.", ".....##.#.......#....#...#.....", "......#.#....##................", "..#..........###..#..#.#..#....", "....#..............#....##..#.#", ".#.........#.#....#.#.#....#...", "..#.....#......##.#....#.......", "..#.#....#..#.#...##....###....", "...#......##...#........#.#..#.", ".##.#.......##....#............", "...##..#.#............#...#.#..", ".##...##.#..#..................", "..#......##......#......##.....", ".....##...#..#...#.........#...", ".##.#.....#..#..#.##....##....#", "..#.#......#.......##..........", "......................#......##", "##.#...#.................#.#.#.", "......#.#..........#.....##.#..", "#.#......#.....#...........#...", ".....#...#.......#..#..#.#...#.", "...........#......#.#...#......", "....##...##...........#......#.", ".........#.##..................", "......#...#....#......##.##...#", "......#...#.#########......#...", ".......#.#...#.......#..#......", "............#...#...#.###...##.", "...........#..........#...#....", "...#..#.#................#.#..#", "..#....#.....#.............#.#.", "....##......#........#....#....", "........##...............#....#", "........#..#...#..............#", "...#....#.#...#..#...#....#.#.#", ".........#.......#....##.......", "#.##..............#.#........##", "......................###......", ".........#....##..##....#.#.#..", ".#...##.#.#...#....##..#.....#.", "....................#.#......#.", ".#..#.......................#..", "..#..#.............#..#....#...", "...#...#..#...#...#.#..#.##....", "........#....#...#....#........", ".#.....#........#.........#...#", "...#......#..#..#..####..#.....", "#....#..............#.##.......", ".#....#.............##...#.....", "....#...#.##........##......#..", "##....#...#.......#..#........#", "....##........................#", "..................#..#.........", "..#....#........#..#.......#...", "#...#..#....#...##...........#.", ".........#..#..#.#.##..........", "....#.#..#.....#..#.#.#.#..#.##", "##................#.##.....#...", ".#.....###..#..#..#.....#....##", "...#...........#..........####.", ".#.....#....#......#.##..#.#...", "..#...##....#................#.", "........#.......#......#.#.....", "....#.#.#.#....#...#......#..#.", "...........#......#..#.........", "###...##......##.#..#....##....", "##....##.........#..#....###...", "#.#.....#....#......#...#..##..", "#....##.#..............#.##....", ".#........#.#.........#...#....", "......................#......#.", "........#..#..##.....#..#.#....", "..#...###.................#..#.", "...#...#............#..........", ".##.......#..#.........#....#..", ".#..............#....#....##...", "...............##..#.#.......##", ".#.....#....#...#..#.......#..#", "#..#.............#....#......#.", ".....#.#......#.........###..#.", ".#...#.#...............#....#..", "#......#.............#.........", ".#.##.#.####...#..#.##..#.....#", ".....#......#..#...#.......#...", "#........###...#.....#..#.....#", "....#.#.....#...#..........#...", "...#.#.......#.#......#..#.##..", "..#..........#.#..#.......#.#..", "#...#.#..............#...###.#.", "...#..#...#............###.....", "..#..#...#.#............#..#...", ".###.#.....................#..#", "....#....#..#.....##.##........", "#....#....#.#..#.........#.....", ".#.....##....#............##..#", "#....#.#...#...#..#.#......#...", "#.....##.....##.....##.#...##..", "...##...#..#..####.#........#..", ".........#...#......##..##..#..", "..#.....###.#..#..####.#.......", ".......#......#...#..##....#...", ".#.....#.#.#..#....#...#..##...", "..........#.#...#...#.#..#.....", "....#.....#........#.....##..#.", "..#.#.##.........#...##.....##.", ".........#.##....#............#", "............##.....#.......#.#.", "......#.....#...#..#..###......", "##.....#.......#...##.#....#...", "...........##......#..##...#.#.", "..#.#.#.#...#.......#....#...#.", "#.............#.....#.#...###..", "##....#.......#.....#..##.#....", "...#.......#....#.........##...", "......#.......#......##.##.....", "..#......#...#.#........#......", "....#.#....#.#.##......#.....#.", "#......#.........#..#....#.....", "........#..#....##.....#.......", "#......##....#.##....#......#..", "..#.......#............##.....#", "...........#...#...........#...", "#.......#...#....#....#...#.#.#", "..###..#........#........#.....", "..#..###...........#.#......#..", ".#...........#......#..........", ".#.......#.....#.......#.......", "..#......##.#............#....#", "#..........#.....#.#..#........", ".....#...##.##.......#......#..", "..........#.....#........#.#.#.", "....#......#.....#......#.#....", ".........#.#.#..#...##....#...#", ".........#.......#...##...#.#..", ".##........#...............#...", ".......#....#...........##.....", ".........###......#.........#.#", "......#.......#...#..........#.", "...#.#..........##......#...#..", "#.......#.#..........#.........", "................#..#......#..##", ".....#...#....#.#.....#........", "#.....#....#...........#....#..", "#....#.#..#...##....#...##.#...", "...#.....#......#.#....#..#..#.", "..#................#...#.#..##.", "..........#..............#..#.#", ".....##.....#..#.###...........", "....#.#......#.#...........#...", ".#....#.#.........##.#....#....", ".#.#........#........###....#..", "##.#................#...#..#...", ".......#......##..#.....#..#.#.", "...#............#......###...##", "#.#...........#.........#......", ".....#.#.#.................#...", "....#..............#...#.#.....", "...#.#.....##..#...............", ".#..##...#....##.....###..#....", "...............#...#...#.#.###.", ".###....#.....#...#.#......#...", "...#..#.....#.......#..##.#....", "...........#..#....##..#...#...", "...#...#..........#.......##.#.", "............#.#.......#........", "....#.........#.....#..........", "...#.###.##..#...##..####..#..#", ".#.#...#..#...................#", ".....#..#.....##..#............", "....#......#...##..#.##........", "...#...............#..#.....##.", "...#......#.........#.#..##....", ".#....#.##.......#......#......", "....#.......#....#..........#..", "#.#.#....###.#.#.............#.", "..##..###........#.#..#.#..#...", "......#.#............##.#...###", ".........#.#....#####.....##...", "............##......#.#..#.....", "...#.....#.....###....#........", "##..........####.##.#.#........", "....................##.....##.#", "#.#............#........#......", "....#...##.....#......#....#...", "...###.#..##..................#", "..###......#..............#.#.#", ".#...#...........#....#........", "....#............#..#..#.#.....", "...#.........#.#.........#.####", "..#...#...#...#...........#....", "...............#.#......##..#..", "#....#.#.......#.#..#......#..#", "........#.#....#..#...#..#...#.", "...#..#.......#...........#....", "...........#.......#...........", ".#......#................#.....", "....#.#.#...#......#..#...#....", "................#.#.#....#.....", ".........................##..#.", ".#...........#............##...", "#...............#.....##.#.#..#", ".........#.......###....#.....#", "....##...#...#.....#..#........", "........#.....#..#.#.#...#..#..", "......#.......#.#.........#.#..", "#......#............#...#....#.", "#..##...#..#................#..", ".##...#...#.....#.##.......#..#", ".......#.##........##..##......", "##.#..##...............#.....#.", "......#....#..##...#......###.#", "#........##..#....#.#......#...", ".#......##.#...#.#...#.........", ".#.#...#..#.............#......", ".##..........#..........#......", ".#.....#.....#..............#.#", "..#.........#..#.#.....#.#....#", "..#.##..............##...#..###", "....................#..........", "......###..#..#...........#....", "..#..........#.......#...#.....", "...#......#......#.............", "....##..............#.#.....#..", "........#.#......#..#........##", ".............#...#.#.........##", "...###...#..........##.......#.", ".#..........#...##..#.#.....#..", "##...#.........#...............", "......#....#....#.....#.....#..", "..........#....#...#...#..#...#", "...##....#.#.#..#...##.........", "#......#.#...##.###...#....#...", "##.......##.#......##..#...#...", "......#.............#.##.....##", "#.......###....####.#...##....#", "..#...#..#.......#..........#..", "#.....#..#..#..#.##...###...#..", ".....##.#..#..#..#.#....#...#..", "..#...#..................##....", "....#.#........##..............", "#...#.......##...#...#.#.......", "..#...#........##....#.#.......", "..........###...###...#......#.", "#.....#..###...##...##..#..#..#", "..#.....##.....#.......##..#.#.", "........#........#.........#...", ".................#....#.......#", ".......#...#.....#...#.#.......", "....##...............#...##...#", ".##...#................#...#...", ".............#.................", ".#..#....#....#.#....#.........", ".#.#..#..........#.......#.....", ".....##.....##...#..#..........", "#...#.#.........#......#..#....", "........#....#...#....#.#.##...", "....#..#........#...#...#......", ".#..#.....#.#...#.........#....", ".#..#..#...........#..#....#...", "....###.............#..#.......", "#......#..#..##..........#.#...", "#..#..#.##..#...#.#.#..........", "....###......#.##.....#....#...", ".##..#...#......##.#...........", "..#..#.......#.....#.##....#.#.", ".......#.#.#........#....##....", "..##...#....#...............###", "#..##..#...........#.#....##...", "...##..#.....................#.", "###......#....#....###..#...##.", ".........##............#..#...#", "..#..........#...#.#.#......#.#", ".......#.....##..##......#.##..", "#..........#.....##.#..........", "#.......#.#...#...#....#.......", "#...#.....##.......#.#..#.#.#..", ".........#.#.#..#..#...#.###...", ".................##...#....#...", "###.......#..........##...#....", "#.#..#.........#....##.#.......", "......#.#.....#........#.......", ".......#.#........#......#.#..#", "..............#..#...##....#..#", "#...........#...##.....#..#.#..", "..#....#..#.#.#...#..#....#.#..", "...##.#.....#..#...##..#.....#.", "..#.#................#........#", "......#...#.............#......", ".##............#....#...#..#...", "....#...#...........#.......#..", ".###..#.......#.............#.#", ".#.#....#.#...........#.#......", "...#.........#.........#..#....", "...#..........#.#.....#.#......", ".....#........#....##......#...", "..#.#.#......#..#.#......#....#", ".#.#..#................#.#.....", ".#.#.........##...#.......#.#.#", "#..#.....#...#..#...........#..", "..##......####......#..#....###", "#.....###....#.#........#..#..#", "..##.#...#.#..##..........#..#.", "#.........#.#.............#...#", "...#.#...#...#.#.#....##.......", "##.##...#.....#...#...........#", "....#........#.#.....#.........", ".................##..#..##...##", ".....##....#...#...#.....#..#..", "....#...#........#............#", "..#...........##....#...#...##.", ".....#......#.........#..##.#.."

#Variables
##Count number of lines to be processed
[int]$dataLines = ($data | measure).count
$totalCount = 0

function Wrap-Length {
    #check line length. If too long, wrap around.
    if ($currentPosition[1] -gt $line.length) {
        $currentPosition[1] = $currentPosition[1] - $line.length
        }
    }

function Check-EOF {
    #Check if final line has been read, if not count upward, wrapping if necessary
    if ($currentPosition[0] -le $dataLines) {
        $currentPosition[0] = $currentPosition[0]+$moveDown
        $currentPosition[1] = $currentPosition[1]+$moveRight
        Wrap-Length
    }
}

function Check-Slopes($moveRight,$moveDown) {
    # Process Lines in File
    ## These variables reset the starting position
    $downPosition = 1
    $rightPosition = 1
    $currentPosition = $downPosition, $rightPosition
    Write-host "Movement will be $moveRight over and $moveDown Down"
    
    # Start Script
    $currentStep = 1
    foreach ($line in $data) {
    Wrap-Length

    # For dowward intervals of 1
    if ($moveDown -eq 1) {

        # Count Trees for current line
        #Write-Host "Step $currentStep, Location $currentPosition $line"
        $treeVar = $line.substring($currentPosition[1]-1,1)
            if ($treeVar -eq "#") {
                $totalCount = $totalCount + 1
            }
        Check-EOF
    
    #Increment Step by 1
    $currentStep = $currentStep +1
    }

    # For downward intervals of 2
    if ($moveDown -eq 2) {
        If ($currentStep % 2 -eq 1) {
            #Write-Host "Step $currentStep, Location $currentPosition $line"
            $treeVar = $line.substring($currentPosition[1]-1,1)
            if ($currentPosition[0] -le $dataLines) {
                $currentPosition[0] = $currentPosition[0]+1 }   
            #Increment Step by 1
            $currentStep = $currentStep +1
        } Else {
            #Write-Host "Step $currentStep, Location $currentPosition $line"   
            if ($currentPosition[0] -le $dataLines) {
                $currentPosition[0] = $currentPosition[0]+1
                $currentPosition[1] = $currentPosition[1]+$moveRight }
            if ($treeVar -eq "#") {
                $totalCount = $totalCount + 1
            }
            #Increment Step by 1
            $currentStep = $currentStep +1            
        }
    }
    }
      Write-host "$dataLines lines processed; $totalCount trees encountered"
    }

## These variables map the movement of slope trajectories for each pass (Right, Down)
$slope1 = 1, 1
$slope2 = 3, 1
$slope3 = 5, 1
$slope4 = 7, 1
$slope5 = 1, 2

# Start Script
Check-Slopes $slope1[0] $slope1[1]
Check-Slopes $slope2[0] $slope2[1]
Check-Slopes $slope3[0] $slope3[1]
Check-Slopes $slope4[0] $slope4[1]
Check-Slopes $slope5[0] $slope5[1]
